


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Philip Irvine - Personal Website</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #1B4965 0%, #2A9D8F 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hero-gradient {
            background: linear-gradient(135deg, #1B4965 0%, #2A9D8F 100%);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .fade-in {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease;
        }
        
        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .smooth-scroll {
            scroll-behavior: smooth;
        }
        
        .nav-blur {
            backdrop-filter: blur(10px);
            background-color: rgba(250, 250, 250, 0.9);
        }
        
        .sparkle-border {
            position: relative;
        }
        
        .ai-border { border: 3px solid #2A5FD6; }
        .healthcare-border { border: 3px solid #5AB366; }
        .leadership-border { border: 3px solid #C56A2A; }
    </style>
</head>
<body class="smooth-scroll">
    <!-- Navigation -->
    <nav class="fixed top-0 z-50 nav-blur border-b border-gray-200">
        <div class="container mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <div class="text-2xl font-bold gradient-text">PI</div>
                <div class="hidden md:flex space-x-8">
                    <a href="#home" class="text-gray-700 hover:text-[#1B4965] transition-colors">Home</a>
                    <a href="#about" class="text-gray-700 hover:text-[#1B4965] transition-colors">About</a>
                    <a href="#skills" class="text-gray-700 hover:text-[#1B4965] transition-colors">Skills</a>
                    <a href="#projects" class="text-gray-700 hover:text-[#1B4965] transition-colors">Projects</a>
                    <a href="#contact" class="text-gray-700 hover:text-[#1B4965] transition-colors">Contact</a>
                </div>
                <button id="mobile-menu-btn" class="md:hidden">
                    <i class="fas fa-bars text-2xl text-gray-700"></i>
                </button>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-[#FAFAFA] border-t border-gray-200">
            <div class="px-6 py-4 space-y-3">
                <a href="#home" class="block text-gray-700 hover:text-[#1B4965] transition-colors">Home</a>
                <a href="#about" class="block text-gray-700 hover:text-[#1B4965] transition-colors">About</a>
                <a href="#skills" class="block text-gray-700 hover:text-[#1B4965] transition-colors">Skills</a>
                <a href="#projects" class="block text-gray-700 hover:text-[#1B4965] transition-colors">Projects</a>
                <a href="#contact" class="block text-gray-700 hover:text-[#1B4965] transition-colors">Contact</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="min-h-screen flex items-center justify-center hero-gradient text-white">
        <div class="container mx-auto px-6 text-center">
            <div class="fade-in">
                <h1 class="text-5xl md:text-7xl font-bold mb-6">
                    Hi, I'm <span class="text-[#CAE9FF]">Philip Irvine</span>
                </h1>
                <div class="text-2xl md:text-3xl mb-8 typing-cursor" id="typing-text">
                    I'm a passionate developer
                </div>
                <p class="text-xl md:text-2xl mb-12 max-w-3xl mx-auto opacity-90">
                Applying AI engineering to improve health outcomes, optimise systems, and reveal insights that matter                </p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <a href="#contact" class="bg-[#FAFAFA] text-[#1B4965] px-8 py-4 rounded-full font-semibold hover:bg-gray-200 transition-colors">
                        Get In Touch
                    </a>
                    <a href="#projects" class="border-2 border-[#CAE9FF] text-white px-8 py-4 rounded-full font-semibold hover:bg-[#CAE9FF] hover:text-[#1B4965] transition-all">
                        View My Work
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="py-20 bg-[#FAFAFA]">
        <div class="container mx-auto px-6">
            <div class="fade-in">
                <h2 class="text-4xl font-bold text-center mb-16 gradient-text">About Me</h2>
                <div class="grid md:grid-cols-2 gap-12 items-center">
                    <div>
                        <img src="https://raw.githubusercontent.com/Philip-Irvine/philip-irvine.io/main/images/profile_picture.JPG" 
                             alt="Philip Irvine" 
                             class="rounded-2xl shadow-2xl max-w-md mx-auto object-cover h-96"
                             onerror="console.log('Image failed to load'); this.src='https://via.placeholder.com/400x400/1B4965/FFFFFF?text=Philip+Irvine'; console.log('Fallback loaded');"
                             onload="console.log('Profile image loaded successfully');"
                             loading="lazy">
                    </div>
                    <div>
                        <h3 class="text-2xl font-semibold mb-4">Passionate about improving health care </h3>
                        <p class="text-gray-600 mb-6 leading-relaxed">
                            Drawing on my nursing background, I bridge clinical expertise with AI engineering to design and 
                            apply machineâ€‘learning tools that turn complex health data into meaningful, actionable insights. 
                            I build dataâ€‘driven applications that support better decisions, enhance clarity, and empower practitioners and managers.
                        </p>
                        <p class="text-gray-600 mb-8 leading-relaxed">
                            When I'm not coding, you'll find me exploring new technologies, contributing to 
                            open-source projects, or continuously learning to stay at the forefront of AI engineering.
                        </p>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="flex items-center space-x-3">
                                <i class="fas fa-check-circle text-[#2A9D8F]"></i>
                                <span class="text-gray-700">Problem Solver</span>
                            </div>
                            <div class="flex items-center space-x-3">
                                <i class="fas fa-check-circle text-[#2A9D8F]"></i>
                                <span class="text-gray-700">Team Player</span>
                            </div>
                            <div class="flex items-center space-x-3">
                                <i class="fas fa-check-circle text-[#2A9D8F]"></i>
                                <span class="text-gray-700">Fast Learner</span>
                            </div>
                            <div class="flex items-center space-x-3">
                                <i class="fas fa-check-circle text-[#2A9D8F]"></i>
                                <span class="text-gray-700">Detail Oriented</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Skills Section -->
    <section id="skills" class="py-20 bg-white">
        <div class="container mx-auto px-6">
            <div class="fade-in">
                <h2 class="text-4xl font-bold text-center mb-16 gradient-text">Skills & Expertise</h2>
                <div class="space-y-12">
                    <!-- AI Engineering & Machine Learning -->
                    <div class="rounded-2xl shadow-lg sparkle-border ai-border">
                        <div class="grid md:grid-cols-3 gap-0">
                            <div class="md:col-span-1 bg-[#3A7DFF] flex items-center justify-center rounded-l-2xl">
                                <div class="text-center p-8">
                                    <div class="text-5xl mb-4 text-white">
                                        <i class="fas fa-brain"></i>
                                    </div>
                                    <h3 class="text-xl font-semibold text-white">AI Engineering & Machine Learning</h3>
                                </div>
                            </div>
                            <div class="md:col-span-2 p-8 bg-white rounded-r-2xl">
                                <ul class="space-y-3">
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-[#3A7DFF] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Building endâ€‘toâ€‘end ML pipelines for prediction, classification, and insight generation</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-[#3A7DFF] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Applied AI: LLM prompting, RAG pipelines, embeddings, and model fineâ€‘tuning</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-[#3A7DFF] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Data engineering fundamentals: Python, SQL, data modelling, ETL, and workflow automation</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-[#3A7DFF] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Designing reproducible, modular solutions aligned with realâ€‘world operational needs</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Healthcare & Clinical Insight -->
                    <div class="rounded-2xl shadow-lg sparkle-border healthcare-border">
                        <div class="grid md:grid-cols-3 gap-0">
                            <div class="md:col-span-1 bg-[#6BCB77] flex items-center justify-center rounded-l-2xl">
                                <div class="text-center p-8">
                                    <div class="text-5xl mb-4 text-white">
                                        <i class="fas fa-heartbeat"></i>
                                    </div>
                                    <h3 class="text-xl font-semibold text-white">Healthcare & Clinical Insight</h3>
                                </div>
                            </div>
                            <div class="md:col-span-2 p-8 bg-white rounded-r-2xl">
                                <ul class="space-y-3">
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-[#6BCB77] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Registered nurse with extensive experience across acute, community, and residential care</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-[#6BCB77] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Deep understanding of clinical workflows, risk assessment, safeguarding, and patient pathways</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-[#6BCB77] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Translating complex health data into meaningful insights for practitioners and managers</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-[#6BCB77] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Evidenceâ€‘based practice, quality improvement, and clinical audit expertise</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Operational Leadership & Systems Thinking -->
                    <div class="rounded-2xl shadow-lg sparkle-border leadership-border">
                        <div class="grid md:grid-cols-3 gap-0">
                            <div class="md:col-span-1 bg-[#D97A3A] flex items-center justify-center rounded-l-2xl">
                                <div class="text-center p-8">
                                    <div class="text-5xl mb-4 text-white">
                                        <i class="fas fa-cogs"></i>
                                    </div>
                                    <h3 class="text-xl font-semibold text-white">Operational Leadership & Systems Thinking</h3>
                                </div>
                            </div>
                            <div class="md:col-span-2 p-8 bg-white rounded-r-2xl">
                                <ul class="space-y-3">
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-[#D97A3A] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Leading multidisciplinary teams and managing largeâ€‘scale service operations</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-[#D97A3A] mt-1 mr-3"></i>
                                        <span class="text-gray-700">KPI design, performance monitoring, and dataâ€‘driven decision support</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-[#D97A3A] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Process optimisation, service transformation, and change management</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-[#D97A3A] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Turning organisational challenges into structured, measurable, and solvable problems</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Projects Section -->
    <section id="projects" class="py-20 bg-[#FAFAFA]">
        <div class="container mx-auto px-6">
            <div class="fade-in">
                <h2 class="text-4xl font-bold text-center mb-16 gradient-text">Featured Projects</h2>
                
                <!-- Project 1 -->
                <div class="mb-20">
                    <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
                        <div class="bg-gradient-to-r from-[#1B4965] to-[#2A9D8F] text-white p-6">
                            <h3 class="text-2xl font-bold mb-2">COVID-19 Mortality Wave Analysis: A Cross-National Time Series Study</h3>
                            <p class="opacity-90">Project Overview</p>
                        </div>
                        
                        <div class="p-8">
                            <div class="bg-[#FAFAFA] p-6 rounded-xl mb-6">
                                <h4 class="text-lg font-semibold mb-4 text-[#1B4965] flex items-center">
                                    <i class="fas fa-cogs mr-3 text-[#2A9D8F]"></i>
                                    Methodological Approach
                                </h4>
                                <ul class="space-y-3">
                                    <li class="flex items-start">
                                        <i class="fas fa-database text-[#2A9D8F] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Data sourced from national statistical agencies and excess mortality trackers</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-chart-line text-[#2A9D8F] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Population-normalised metrics (deaths per 100k)</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-wave-square text-[#2A9D8F] mt-1 mr-3"></i>
                                        <span class="text-gray-700">7-day rolling averages applied for smoothing</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-globe text-[#2A9D8F] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Cross-national time alignment</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-search text-[#2A9D8F] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Peak detection and comparative trend analysis</span>
                                    </li>
                                </ul>
                            </div>
                            
                            <div class="bg-[#FAFAFA] p-6 rounded-xl mb-6">
                                <h4 class="text-lg font-semibold mb-4 text-[#1B4965] flex items-center">
                                    <i class="fas fa-bullseye mr-3 text-[#2A9D8F]"></i>
                                    Project Aims
                                </h4>
                                <ul class="space-y-3">
                                    <li class="flex items-start">
                                        <i class="fas fa-exchange-alt text-[#2A9D8F] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Translate complex public health data into structured insight</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-project-diagram text-[#2A9D8F] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Identify systemic patterns across large datasets</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-comments text-[#2A9D8F] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Communicate quantitative findings clearly and professionally</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-bridge text-[#2A9D8F] mt-1 mr-3"></i>
                                        <span class="text-gray-700">Bridge clinical understanding with data science analysis</span>
                                    </li>
                                </ul>
                            </div>
                            </div>
                        
                        <div class="p-8">
                            <!-- Key Findings -->
                            <div class="mb-8">
                                <h4 class="text-xl font-semibold mb-4 text-[#1B4965] flex items-center">
                                    <i class="fas fa-lightbulb mr-3 text-[#2A9D8F]"></i>
                                    Key Findings
                                </h4>
                                <div class="bg-[#FAFAFA] p-6 rounded-xl">
                                    <ul class="space-y-3">
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-[#2A9D8F] mt-1 mr-3"></i>
                                            <span class="text-gray-700">Recurrent Wave Cycles in Continental Europe, Britain, Italy, and France experienced multiple 
                                                pronounced mortality waves, reflecting sustained transmission cycles influenced by variant emergence (Alpha, Delta, Omicron) and seasonal pressures.
                                                These recurrent peaks suggest systemic vulnerability to variant-driven resurgences despite public health interventions.</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-[#2A9D8F] mt-1 mr-3"></i>
                                            <span class="text-gray-700">Delayed and Attenuated Mortality in Island Nations. New Zealand and Australia demonstrated significantly delayed mortality impact. 
                                                Geographic isolation and strict border controls limited early spread, producing flat mortality curves until Omicron breached containment in 2022.
                                                This illustrates how structural geography can shape epidemiological trajectories.</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-[#2A9D8F] mt-1 mr-3"></i>
                                            <span class="text-gray-700">Peak mortality per 100k was substantially higher in the UK and Italy compared to France, 
                                                and markedly lower in New Zealand. This suggests differences in: Healthcare system strain, Policy timing, Population exposure dynamics</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            
                            <!-- Key Graphs -->
                            <div class="mb-8">
                                <h4 class="text-xl font-semibold mb-4 text-[#1B4965] flex items-center">
                                    <i class="fas fa-chart-line mr-3 text-[#2A9D8F]"></i>
                                    Key Graphs
                                </h4>
                                <div class="grid md:grid-cols-1 gap-6">
                                    <div class="bg-[#FAFAFA] p-6 rounded-xl">
                                        <img src="https://raw.githubusercontent.com/Philip-Irvine/philip-irvine.io/main/images/britain_covid_deaths.png" 
                                             alt="The Rise and Fall of COVID Fatalities in UK" 
                                             class="w-full h-96 object-contain rounded-lg mb-4"
                                             onerror="this.src='https://via.placeholder.com/400x250/1B4965/FFFFFF?text=UK+COVID+Fatalities'; console.log('UK COVID fatalities graph fallback loaded');"
                                             loading="lazy">
                                        <h5 class="font-semibold mb-2">The Rise and Fall of COVID Fatalities in UK</h5>
                                        <p class="text-gray-600 text-sm">The graph shows Britain's COVID-19 story in three strokes: two huge, deadly waves in 2020 and early 2021, followed by a clear drop-off as vaccines and better treatments took hold. After mid-2021 spikes flatten, marking the shift from crisis to control</p>
                                    </div>
                                    <div class="bg-[#FAFAFA] p-6 rounded-xl">
                                        <img src="https://raw.githubusercontent.com/Philip-Irvine/philip-irvine.io/main/images/Reported%20Weekly%20COVID%20Deaths%20in%204%20countries.png" 
                                             alt="Multi-Country Mortality Time Series" 
                                             class="w-full h-96 object-contain rounded-lg mb-4"
                                             onerror="this.src='https://via.placeholder.com/400x250/1B4965/FFFFFF?text=COVID+Mortality+Graph'; console.log('COVID graph fallback loaded');"
                                             loading="lazy">
                                        <h5 class="font-semibold mb-2">Europeâ€™s Deadly Waves vs New Zealandâ€™s Flat Line (four countries, same timeline)</h5>
                                        <p class="text-gray-600 text-sm">Britain, France, and Italy all show repeated, highâ€‘intensity waves of COVIDâ€‘19 deaths, with Britain hitting the steepest peak in early 2021. France and Italy follow similar patternsâ€”multiple surges, rising and falling in tandemâ€”though Italyâ€™s firstâ€‘wave spike is especially pronounced. In contrast, New Zealand sits in a league of its own: nearâ€‘flat mortality for almost two years, only lifting slightly in 2022. The graph makes the divide unmistakableâ€”Europe battled recurring deadly waves, while New Zealand kept deaths close to zero until the Omicron era. </p>
                                    </div>
                                    <div class="bg-[#FAFAFA] p-6 rounded-xl">
                                        <img src="https://raw.githubusercontent.com/Philip-Irvine/philip-irvine.io/main/images/worldwide_covid_deaths_per100k.png" 
                                             alt="Global COVID-19 Mortality Wave Analysis" 
                                             class="w-full h-96 object-contain rounded-lg mb-4"
                                             onerror="this.src='https://via.placeholder.com/400x250/1B4965/FFFFFF?text=Global+COVID+Graph'; console.log('Global COVID graph fallback loaded');"
                                             loading="lazy">
                                        <h5 class="font-semibold mb-2">Global COVID-19 Mortality Wave Analysis</h5>
                                        <p class="text-gray-600 text-sm">This time-series visualisation presents global weekly COVID-19 deaths per 100,000 population from early 2020 through mid-2022.
                                            Using population-normalised mortality data and temporal smoothing, the graph reveals cyclical structure of pandemic across successive global waves.
                                            Three major mortality surges are clearly visible: Initial Wave (2020) â€“ Rapid emergence and first global impact
                                            Major Winter Surge (Early 2021) â€“ Highest mortality intensity
                                            Omicron-Driven Wave (Early 2022) â€“ High transmission but lower peak lethality </p>
                                        <p class="text-gray-600 text-sm">Worldwide Weekly COVID-19 Deaths per 100k (2020â€“2022)</p>
                                    </div>
                                    <div class="bg-[#FAFAFA] p-6 rounded-xl">
                                        <img src="https://raw.githubusercontent.com/Philip-Irvine/philip-irvine.io/main/images/Reported%20Weekly%20COVID%20Deaths%20in%202%20countries.png" 
                                             alt="How Australia and New Zealand Faced the COVID Waves" 
                                             class="w-full h-96 object-contain rounded-lg mb-4"
                                             onerror="this.src='https://via.placeholder.com/400x250/1B4965/FFFFFF?text=AUS+NZ+COVID+Waves'; console.log('AUS NZ COVID waves graph fallback loaded');"
                                             loading="lazy">
                                        <h5 class="font-semibold mb-2">How Australia and New Zealand Faced the COVID Waves</h5>
                                        <p class="text-gray-600 text-sm">This chart contrasts how Australia and New Zealand experienced COVID-19 mortality over time: Australia saw several moderate waves before a sharp rise in early 2022, while New Zealand kept deaths near zero until the Omicron surge hit, sending its curve sharply upward. The result is a clear visual of two countries that started similarly but diverged dramatically once large-scale outbreaks arrived.</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Python Code -->
                            <div>
                                <h4 class="text-xl font-semibold mb-4 text-[#1B4965] flex items-center">
                                    <i class="fas fa-code mr-3 text-[#2A9D8F]"></i>
                                    Python Code
                                </h4>
                                <div class="bg-gray-900 text-gray-100 p-6 rounded-xl overflow-x-auto max-h-96">
                                    <pre class="text-sm"><code class="language-python">#!/usr/bin/env python
# coding: utf-8
# In[2]:
import kagglehub
# Download latest version
path = kagglehub.dataset_download("dhruvildave/covid19-deaths-dataset")
print("Path to dataset files:", path)
# In[ ]:
import pandas as pd
# In[23]:
# ==============================================================
# ðŸ§­ ROBUST MULTI-FILE DATA ANALYSIS WITH JSON & LIST HANDLING
# ==============================================================
import os
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import webbrowser
from ydata_profiling import ProfileReport
# --------------------------------------------------------------
# 1ï¸âƒ£ Define your data folder
# --------------------------------------------------------------
data_folder = r"C:\Users\Philip\Desktop\foundations for drug discovery"  # Folder containing CSV, Excel, or JSON files
# --------------------------------------------------------------
# 2ï¸âƒ£ Helper function: load dataset safely
# --------------------------------------------------------------
def load_dataset(file_path):
    """
    Load CSV, Excel, standard JSON, or newline-delimited JSON.
    """
    if file_path.endswith(".csv"):
        return pd.read_csv(file_path)
    elif file_path.endswith(".xlsx"):
        return pd.read_excel(file_path)
    elif file_path.endswith(".json"):
        try:
            return pd.read_json(file_path)  # Standard JSON
        except ValueError:
            return pd.read_json(file_path, lines=True)  # JSON Lines
    else:
        return None

# --------------------------------------------------------------
# 3ï¸âƒ£ Loop through all files
# --------------------------------------------------------------
for file in os.listdir(data_folder):
    file_path = os.path.join(data_folder, file)

    # Only process supported file types
    if not (file.endswith(".csv") or file.endswith(".xlsx") or file.endswith(".json")):
        continue

    print(f"\n{'='*90}\nðŸ“‚ ANALYSING FILE: {file}\n{'='*90}")

    # Load dataset
    try:
        df = load_dataset(file_path)
    except Exception as e:
        print(f"âŒ Error loading {file}: {e}")
        continue

    # ----------------------------------------------------------
    # 4ï¸âƒ£ Convert list-like columns to strings
    # ----------------------------------------------------------
    for col in df.select_dtypes(include='object').columns:
        if df[col].apply(lambda x: isinstance(x, list)).any():
            df[col] = df[col].apply(lambda x: ", ".join(map(str, x)) if isinstance(x, list) else x)

    # ----------------------------------------------------------
    # 5ï¸âƒ£ Column Summary Table
    # ----------------------------------------------------------
    col_summary = pd.DataFrame({
        'Column': df.columns,
        'Data Type': df.dtypes.astype(str),
        'Missing Values': df.isnull().sum(),
        'Non-Missing Values': df.notnull().sum()
    })
    col_summary['% Missing'] = (col_summary['Missing Values'] / len(df) * 100).round(2)

    print("ðŸ“Š COLUMN SUMMARY TABLE")
    print(col_summary.to_string(index=False))
    print("\n")

    # ----------------------------------------------------------
    # 6ï¸âƒ£ Data Cleaning
    # ----------------------------------------------------------
    df.columns = df.columns.str.strip().str.lower().str.replace(' ', '_', regex=False)
    df = df.drop_duplicates().dropna(how='all')

    for col in df.select_dtypes(include=np.number).columns:
        if df[col].isnull().any():
            df[col] = df[col].fillna(df[col].median())

    for col in df.select_dtypes(include='object').columns:
        if df[col].isnull().any():
            try:
                df[col] = df[col].fillna(df[col].mode()[0] if not df[col].mode().empty else "Unknown")
            except:
                df[col] = df[col].fillna("Unknown")

    print("âœ… Cleaned dataset shape:", df.shape)

    # ----------------------------------------------------------
    # 7ï¸âƒ£ Exploratory Data Analysis (EDA)
    # ----------------------------------------------------------
    numeric_cols = df.select_dtypes(include=np.number).columns
    cat_cols = df.select_dtypes(include='object').columns

    if len(numeric_cols) > 0:
        df[numeric_cols].hist(figsize=(10, 8), bins=20)
        plt.suptitle(f"Numeric Distributions â€” {file}", fontsize=14)
        plt.tight_layout()
        plt.show()

    if len(numeric_cols) > 1:
        plt.figure(figsize=(8, 6))
        sns.heatmap(df[numeric_cols].corr(), annot=True, cmap="coolwarm", fmt=".2f")
        plt.title(f"Correlation Heatmap â€” {file}")
        plt.tight_layout()
        plt.show()

    if len(cat_cols) > 0:
        plt.figure(figsize=(8, 4))
        sns.countplot(data=df, x=cat_cols[0], order=df[cat_cols[0]].value_counts().index)
        plt.title(f"Distribution of {cat_cols[0]} â€” {file}")
        plt.xticks(rotation=45)
        plt.tight_layout()
        plt.show()

    # ----------------------------------------------------------
    # 8ï¸âƒ£ Save cleaned dataset
    # ----------------------------------------------------------
    cleaned_file = os.path.join(data_folder, "cleaned_" + os.path.splitext(file)[0] + ".csv")
    df.to_csv(cleaned_file, index=False)
    print(f"ðŸ’¾ Cleaned file saved: {cleaned_file}")

    # ----------------------------------------------------------
    # 9ï¸âƒ£ Generate ydata-profiling report
    # ----------------------------------------------------------
    print("\nðŸ§  GENERATING YDATA-PROFILING REPORT...")
    try:
        profile = ProfileReport(df, title=f"Profile Report - {file}", explorative=True)
        profile_file = os.path.join(data_folder, f"profile_{os.path.splitext(file)[0]}.html")
        profile.to_file(profile_file)
        print(f"ðŸ“„ YData Profiling report saved: {profile_file}")
        # Automatically open report
        webbrowser.open(f"file://{os.path.abspath(profile_file)}")
    except Exception as e:
        print(f"âš ï¸ Could not generate profiling report for {file}: {e}")

print("\nðŸŽ¯ ANALYSIS COMPLETE â€” All supported files processed.")

# Additional analysis code continues with country-specific visualizations, outlier detection, and comprehensive statistical analysis...

# ==============================================================
# ðŸ§­ Collect column-level summary across all files (enhanced)
# ==============================================================

all_columns_summary = []  # Stores column summaries from all files

# --------------------------------------------------------------
# Loop through all files
# --------------------------------------------------------------
for file in os.listdir(data_folder):
    file_path = os.path.join(data_folder, file)

    # Only process supported file types
    if not (file.endswith(".csv") or file.endswith(".xlsx") or file.endswith(".json")):
        continue

    print(f"\n{'='*90}\nðŸ“‚ ANALYSING FILE: {file}\n{'='*90}")

    # Load dataset
    try:
        df = load_dataset(file_path)
    except Exception as e:
        print(f"âŒ Error loading {file}: {e}")
        continue

    # Convert list-like columns to strings
    for col in df.select_dtypes(include='object').columns:
        if df[col].apply(lambda x: isinstance(x, list)).any():
            df[col] = df[col].apply(lambda x: ", ".join(map(str, x)) if isinstance(x, list) else x)

    # ----------------------------------------------------------
    # Column summary table with example values
    # ----------------------------------------------------------
    summary_rows = []
    for col in df.columns:
        example_val = df[col].dropna().astype(str).iloc[0][:15] if df[col].dropna().shape[0] > 0 else ""
        summary_rows.append({
            'File Name': file,
            'Variable Name': col,
            'Data Type': str(df[col].dtype),
            'Observations': len(df),
            'Missing Values': df[col].isnull().sum(),
            'Non-Missing Values': df[col].notnull().sum(),
            '% Missing': round(df[col].isnull().mean() * 100, 2),
            'Example Value (first 15 chars)': example_val
        })

    col_summary = pd.DataFrame(summary_rows)
    all_columns_summary.append(col_summary)

    # (Continue with cleaning, profiling, etc...)

# ==============================================================
# ðŸ”¹ After all files are processed, combine and save summary
# ==============================================================
summary_df = pd.concat(all_columns_summary, ignore_index=True)
summary_df = summary_df.sort_values(by='% Missing', ascending=False)

# Export to CSV
summary_csv_file = os.path.join(data_folder, "all_files_column_summary.csv")
summary_df.to_csv(summary_csv_file, index=False)

print(f"\nðŸ’¾ Column summary for all files saved as: {summary_csv_file}")
print("\nðŸ“Š Top 20 variables by % Missing:\n")
print(summary_df.head(20))

# Define the file path
file_path = r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv"

# Load the CSV into a DataFrame
df = pd.read_csv(file_path)

# Inspect the first few rows
print(df.head())

# Define the file path
file_path = r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv"

# Load the CSV into a DataFrame
df = pd.read_csv(file_path)

# Inspect the first few rows
print(df.head())


import pandas as pd
import matplotlib.pyplot as plt

# Load dataset and parse dates
df = pd.read_csv(
    r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv",
    parse_dates=['start_date']
)

# Sort by date to ensure proper ordering
df = df.sort_values('start_date')

# Group by start_date and sum across all countries
worldwide = df.groupby('start_date', as_index=False)['covid_deaths'].sum()

# Plot
plt.figure(figsize=(10,5))
plt.plot(worldwide['start_date'], worldwide['covid_deaths'], color='blue', label='Weekly COVID Deaths')
plt.title("Worldwide Reported Weekly COVID Deaths")
plt.xlabel("Start Date")
plt.ylabel("COVID Deaths")
plt.legend()
plt.grid(True)
plt.tight_layout()

# Export as PNG
plt.savefig(r"C:\Users\Philip\Desktop\foundations for drug discovery\worldwide_covid_deaths.png")
plt.show()
# verified in R

import pandas as pd
import matplotlib.pyplot as plt

# Load dataset and parse dates
df = pd.read_csv(r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv", 
                 parse_dates=['start_date'])

# Sort by date to ensure proper ordering
df = df.sort_values('start_date')

# Plot
plt.figure(figsize=(10,5))
plt.plot(df['start_date'], df['covid_deaths_per_100k'], color='blue', label=' Reported Weekly COVID Deaths')
plt.title("Worldwide reported Weekly COVID-19 Deaths per 100k")
plt.xlabel("Start Date")
plt.ylabel("COVID Deaths")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig(r"C:\Users\Philip\Desktop\foundations for drug discovery\Worldwide reported Weekly COVID-19 Deaths per 100k.png")
plt.show() 
#verified in R

import pandas as pd
import matplotlib.pyplot as plt

# Load dataset and parse dates
df = pd.read_csv(r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv", 
                 parse_dates=['start_date'])

# Sort by date to ensure proper ordering
df = df.sort_values('start_date')

# Plot
plt.figure(figsize=(10,5))
plt.plot(df['start_date'], df['excess_deaths_per_100k'], color='blue', label=' Reported Weekly excess Deaths')
plt.title("Worldwide reported Weekly excess_deaths_per_100k")
plt.xlabel("Start Date")
plt.ylabel("COVID Deaths")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig(r"C:\Users\Philip\Desktop\foundations for drug discovery\Worldwide reported Weekly excess_deaths_per_100k.png")
plt.show()
# SHAPE OF GRAPH VERIFIED IN STUDIO r


import pandas as pd
import matplotlib.pyplot as plt

# Load dataset and parse dates
df = pd.read_csv(r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv", 
                 parse_dates=['start_date'])

# Filter for Britain only
df_britain = df[df['country'] == 'Britain'].sort_values('start_date')

# Plot
plt.figure(figsize=(10,5))
plt.plot(df_britain['start_date'], df_britain['covid_deaths'], color='red', label='Weekly COVID Deaths (Britain)')
plt.title("Reported Weekly COVID-19 Deaths in Britain")
plt.xlabel("Start Date")
plt.ylabel("COVID Deaths")
plt.ylim(0, 9000)  # Set y-axis scale
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig(r"C:\Users\Philip\Desktop\foundations for drug discovery\Reported Weekly COVID Deaths in Britain.png")
plt.show() 
# SHAPE OF GRAPH VERIFIED IN STUDIO r


import pandas as pd
import matplotlib.pyplot as plt

# Load dataset and parse dates
df = pd.read_csv(r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv", 
                 parse_dates=['start_date'])

# Filter for Britain only
df_france = df[df['country'] == 'France'].sort_values('start_date')

# Plot
plt.figure(figsize=(10,5))
plt.plot(df_france['start_date'], df_france['covid_deaths'], color='green', label='Weekly COVID Deaths (France)')
plt.title("Reported Weekly COVID-19 Deaths in France")
plt.xlabel("Start Date")
plt.ylabel("COVID Deaths")
plt.ylim(0, 9000)  # Set y-axis scale
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig(r"C:\Users\Philip\Desktop\foundations for drug discovery\Reported Weekly COVID Deaths in France.png")
plt.show() 
# SHAPE OF GRAPH VERIFIED IN STUDIO r


import pandas as pd
import matplotlib.pyplot as plt

# Load dataset and parse dates
df = pd.read_csv(r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv", 
                 parse_dates=['start_date'])

# Filter for Italy only
df_italy = df[df['country'] == 'Italy'].sort_values('start_date')

# Plot
plt.figure(figsize=(10,5))
plt.plot(df_italy['start_date'], df_italy['covid_deaths'], color='blue', label='Weekly COVID Deaths (Italy)')
plt.title("Reported Weekly COVID-19 Deaths in Italy")
plt.xlabel("Start Date")
plt.ylabel("COVID Deaths")
plt.ylim(0, 9000)  # Set y-axis scale
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig(r"C:\Users\Philip\Desktop\foundations for drug discovery\Reported Weekly COVID Deaths in Italy.png")
plt.show() 
# SHAPE OF GRAPH VERIFIED IN STUDIO r


import pandas as pd
import matplotlib.pyplot as plt

# Load dataset and parse dates
df = pd.read_csv(r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv", 
                 parse_dates=['start_date'])

# Filter for Italy only
df_australia = df[df['country'] == 'Australia'].sort_values('start_date')

# Plot
plt.figure(figsize=(10,5))
plt.plot(df_australia['start_date'], df_australia['covid_deaths'], color='gold', label='Weekly COVID Deaths (Australia)')
plt.title("Reported Weekly COVID-19 Deaths in Australia")
plt.xlabel("Start Date")
plt.ylabel("COVID Deaths")
plt.ylim(0, 9000)  # Set y-axis scale
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig(r"C:\Users\Philip\Desktop\foundations for drug discovery\Reported Weekly COVID Deaths in Australia.png")
plt.show() 


import pandas as pd
import matplotlib.pyplot as plt

# --- Load dataset ---
df = pd.read_csv(
    r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv",
    parse_dates=['start_date']
)

# --- Filter for selected countries ---
countries = ["Australia", "New Zealand"]
df_subset2 = df[df['country'].isin(countries)].sort_values('start_date')

# --- Plot time-series for each country ---
plt.figure(figsize=(12,6))
for country in countries:
    subset2 = df_subset2[df_subset2['country'] == country]
    plt.plot(subset2['start_date'], subset2['covid_deaths_per_100k'], label=country)

plt.title("Reported Weekly COVID-19 Deaths per 100k (Australia, New Zealand)")
plt.xlabel("Start Date")
plt.ylabel("COVID Deaths per 100k")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig(r"C:\Users\Philip\Desktop\foundations for drug discovery\Reported Weekly COVID Deaths in 2 countries.png")
plt.show()

import pandas as pd
import matplotlib.pyplot as plt

# --- Load dataset ---
df = pd.read_csv(
    r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv",
    parse_dates=['start_date']
)

# --- Filter for selected countries ---
countries = ["Britain", "France", "Italy", "New Zealand"]
df_subset = df[df['country'].isin(countries)].sort_values('start_date')

# --- Plot time-series for each country ---
plt.figure(figsize=(12,6))
for country in countries:
    subset = df_subset[df_subset['country'] == country]
    plt.plot(subset['start_date'], subset['covid_deaths_per_100k'], label=country)

plt.title("Reported Weekly COVID-19 Deaths per 100k (Britain, France, Italy, New Zealand)")
plt.xlabel("Start Date")
plt.ylabel("COVID Deaths per 100k")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig(r"C:\Users\Philip\Desktop\foundations for drug discovery\Reported Weekly COVID Deaths in 4 countries.png")
plt.show()


import pandas as pd
import matplotlib.pyplot as plt

# Load dataset and parse dates
df = pd.read_csv(
    r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv",
    parse_dates=['start_date']
)

# Group by country and sum covid_deaths_per_100k
country_totals = df.groupby('country', as_index=False)['covid_deaths_per_100k'].sum()

# Sort for clarity
country_totals = country_totals.sort_values('covid_deaths_per_100k', ascending=False)

# Plot as bar chart
plt.figure(figsize=(12,6))
plt.bar(country_totals['country'], country_totals['covid_deaths_per_100k'], color='steelblue')
plt.xticks(rotation=90)
plt.title("Total reported COVID-19 Deaths per 100k by Country")
plt.xlabel("Country")
plt.ylabel("Total COVID Deaths per 100k")
plt.tight_layout()

# Export as PNG
plt.savefig(r"C:\Users\Philip\Desktop\foundations for drug discovery\Total_COVID_Deaths_per100k_by_Country.png")
plt.show()
#verified in R


import pandas as pd
import matplotlib.pyplot as plt

# Load dataset and parse dates
df = pd.read_csv(
    r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv",
    parse_dates=['start_date']
)

# Group by country and sum excess_deaths_per_100k
country_totals = df.groupby('country', as_index=False)['excess_deaths_per_100k'].sum()

# Sort for clarity
country_totals = country_totals.sort_values('excess_deaths_per_100k', ascending=False)

# Plot as bar chart
plt.figure(figsize=(12,6))
plt.bar(country_totals['country'], country_totals['excess_deaths_per_100k'], color='darkorange')
plt.xticks(rotation=90)
plt.title("Total Excess Deaths per 100k by Country")
plt.xlabel("Country")
plt.ylabel("Total Excess Deaths per 100k")
plt.tight_layout()

# Export as PNG
plt.savefig(r"C:\Users\Philip\Desktop\foundations for drug discovery\Total_Excess_Deaths_per100k_by_Country.png")
plt.show()
#verified in R

import pandas as pd
import matplotlib.pyplot as plt
#using Z scores >3 calcuulating countries that were outliers for excess deaths and covid deaths
df = pd.read_csv(
    r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv",
    parse_dates=['start_date']
)

# Calculate z-scores per country
df['excess_z'] = df.groupby('country')['excess_deaths_per_100k'].transform(
    lambda x: (x - x.mean()) / x.std()
)
df['excess_outlier'] = df['excess_z'].abs() > 3

df['covid_z'] = df.groupby('country')['covid_deaths_per_100k'].transform(
    lambda x: (x - x.mean()) / x.std()
)
df['covid_outlier'] = df['covid_z'].abs() > 3

# Pick a country that definitely exists in your dataset
print(df['country'].unique())  # list available countries
country = "Australia"     # replace with one from the list

subset = df[df['country'] == country]

plt.figure(figsize=(10,5))
plt.scatter(subset['start_date'], subset['excess_deaths_per_100k'],
            c=subset['excess_outlier'].map({True:'red', False:'blue'}),
            label='Excess Deaths per 100k')
plt.scatter(subset['start_date'], subset['covid_deaths_per_100k'],
            c=subset['covid_outlier'].map({True:'orange', False:'green'}),
            label='COVID Deaths per 100k', marker='x')
plt.title(f"Outlier Detection for {country}")
plt.xlabel("Week")
plt.ylabel("Deaths per 100k")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.show()

# - Compute total excess deaths per 100k per country (sum across weeks).
# Calculate the global mean and standard deviation of those totals.
#- Compute a zâ€‘score for each country relative to the global distribution.
#- Flag countries with |z|>3 as outliers.
import pandas as pd

# Load dataset
df = pd.read_csv(
    r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv",
    parse_dates=['start_date']
)

# Step 1: Total excess deaths per 100k by country
country_totals = df.groupby('country', as_index=False)['excess_deaths_per_100k'].sum()

# Step 2: Global mean and std
mean_val = country_totals['excess_deaths_per_100k'].mean()
std_val = country_totals['excess_deaths_per_100k'].std()

# Step 3: Compute z-scores
country_totals['z_score'] = (country_totals['excess_deaths_per_100k'] - mean_val) / std_val

# Step 4: Flag outliers (>3 std devs from mean)
outliers = country_totals[country_totals['z_score'].abs() > 3]

print("Outlier countries based on total excess deaths per 100k (>|3| z-score):")
print(outliers.sort_values('z_score', ascending=False))
#verified in R


import pandas as pd

# Load dataset
df = pd.read_csv(
    r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv",
    parse_dates=['start_date']
)

# Step 1: Total COVID deaths per 100k by country
country_totals = df.groupby('country', as_index=False)['covid_deaths_per_100k'].sum()

# Step 2: Global mean and std
mean_val = country_totals['covid_deaths_per_100k'].mean()
std_val = country_totals['covid_deaths_per_100k'].std()

# Step 3: Compute z-scores
country_totals['z_score'] = (country_totals['covid_deaths_per_100k'] - mean_val) / std_val

# Step 4: Flag outliers (>3 std devs from mean)
outliers = country_totals[country_totals['z_score'].abs() > 3]

print("Outlier countries based on total COVID deaths per 100k (>|3| z-score):")
print(outliers.sort_values('z_score', ascending=False))
#verified in R
#Mortality data (COVID deaths, excess deaths) has characteristics that make the >3 SD rule less rational if used alone:
#- Nonâ€‘normal distribution: Mortality rates vary widely across countries due to demographics, healthcare systems, reporting practices, and pandemic waves. The distribution is often skewed, not bellâ€‘shaped.
#- Structural differences: A country with older populations or weaker health systems may naturally have higher totals â€” not necessarily â€œoutliersâ€ in the statistical sense.
#- Reporting artifacts: Some countries had delayed or lumped reporting, creating artificial spikes that look like outliers but are administrative.
#- Context matters: A country with very low deaths could also be flagged as an outlier, but that might reflect successful interventions rather than data error



#IQRâ€‘based outlier detection for your mortality data in both Python and RStudio. 
#This method is more robust than the >3 SD rule because it doesnâ€™t assume normality and handles skewed distributions better.

import pandas as pd

# Load dataset
df = pd.read_csv(
    r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv",
    parse_dates=['start_date']
)

# --- Excess deaths per 100k ---
excess_totals = df.groupby('country', as_index=False)['excess_deaths_per_100k'].sum()

Q1 = excess_totals['excess_deaths_per_100k'].quantile(0.25)
Q3 = excess_totals['excess_deaths_per_100k'].quantile(0.75)
IQR = Q3 - Q1

# Flag outliers
excess_totals['outlier_flag'] = (
    (excess_totals['excess_deaths_per_100k'] < Q1 - 1.5*IQR) |
    (excess_totals['excess_deaths_per_100k'] > Q3 + 1.5*IQR)
)

excess_outliers = excess_totals[excess_totals['outlier_flag']]

print("Outlier countries based on total excess deaths per 100k (IQR method):")
print(excess_outliers.sort_values('excess_deaths_per_100k', ascending=False))


# --- COVID deaths per 100k ---
covid_totals = df.groupby('country', as_index=False)['covid_deaths_per_100k'].sum()

Q1 = covid_totals['covid_deaths_per_100k'].quantile(0.25)
Q3 = covid_totals['covid_deaths_per_100k'].quantile(0.75)
IQR = Q3 - Q1

covid_totals['outlier_flag'] = (
    (covid_totals['covid_deaths_per_100k'] < Q1 - 1.5*IQR) |
    (covid_totals['covid_deaths_per_100k'] > Q3 + 1.5*IQR)
)

covid_outliers = covid_totals[covid_totals['outlier_flag']]

print("Outlier countries based on total COVID deaths per 100k (IQR method):")
print(covid_outliers.sort_values('covid_deaths_per_100k', ascending=False))
#verified in R


#Excess vs COVID ratio outlier detection methodology is so powerful, especially for portfolio and career applications:

#ðŸ“ Methodological Strengths
#- Simple but rigorous metric:
#- The ratio \frac{\mathrm{Excess\  deaths\  per\  100k}}{\mathrm{COVID\  deaths\  per\  100k}} is intuitive yet revealing.
#- It directly compares observed COVID mortality to broader excess mortality, exposing discrepancies in reporting or collateral effects.
#- Statistical robustness:
#- Using zâ€‘scores standardizes the ratio across countries, making results comparable regardless of scale.
#- Outlier detection with |z|>3 is a wellâ€‘established statistical threshold, giving credibility to your findings.
#- Dual perspectives:
#- Positive outliers: Excess >> COVID â†’ possible underâ€‘reporting of COVID deaths or indirect pandemic impacts.
#- Negative outliers: COVID >> Excess â†’ possible overâ€‘attribution of deaths to COVID or strong mitigation reducing other causes.

#ðŸŒ Epidemiological & Policy Insights
#- Reveals hidden dynamics: Outliers highlight countries where mortality patterns diverge from global norms.
#- Contextual interpretation: For example, New Zealandâ€™s negative excess mortality reflects strict interventions reducing nonâ€‘COVID deaths.
#- Policy evaluation: Helps assess whether interventions led to collateral benefits or distortions in reporting.



import pandas as pd
import matplotlib.pyplot as plt

# --- Load dataset ---
df = pd.read_csv(
    r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv",
    parse_dates=['start_date']
)

# --- Step 1: Aggregate totals per country ---
totals = df.groupby('country', as_index=False).agg({
    'excess_deaths_per_100k': 'sum',
    'covid_deaths_per_100k': 'sum'
})

# --- Step 2: Compute ratio ---
totals['ratio'] = totals['excess_deaths_per_100k'] / totals['covid_deaths_per_100k']

# --- Step 3: Compute z-scores ---
mean_val = totals['ratio'].mean()
std_val = totals['ratio'].std()
totals['z_score'] = (totals['ratio'] - mean_val) / std_val

# --- Step 4: Flag outliers (|z| > 3) ---
totals['outlier_flag'] = totals['z_score'].abs() > 3

# --- Step 5: Print outliers ---
outliers = totals[totals['outlier_flag']]
print("Outlier countries based on Excess vs COVID ratio (>|3| z-score):")
print(outliers.sort_values('z_score', ascending=False))

# --- Step 6a: Scatterplot (Excess vs COVID deaths) ---
plt.figure(figsize=(8,6))
plt.scatter(totals['covid_deaths_per_100k'], totals['excess_deaths_per_100k'],
            c=totals['outlier_flag'].map({True:'red', False:'blue'}))
plt.plot([0, totals['covid_deaths_per_100k'].max()],
         [0, totals['covid_deaths_per_100k'].max()],
         'k--', label='y=x (Excess=COVID)')
for _, row in outliers.iterrows():
    plt.text(row['covid_deaths_per_100k'], row['excess_deaths_per_100k'],
             row['country'], fontsize=8, ha='right')
plt.xlabel("COVID deaths per 100k")
plt.ylabel("Excess deaths per 100k")
plt.title("Excess vs COVID Deaths per 100k (Outliers Highlighted)")
plt.legend()
plt.tight_layout()
plt.show()

# --- Step 6b: Scatterplot (Ratio vs Z-score) ---
plt.figure(figsize=(8,6))
plt.scatter(totals['ratio'], totals['z_score'],
            c=totals['outlier_flag'].map({True:'red', False:'blue'}))
for _, row in outliers.iterrows():
    plt.text(row['ratio'], row['z_score'], row['country'], fontsize=8, ha='right')
plt.axhline(3, color='gray', linestyle='--')
plt.axhline(-3, color='gray', linestyle='--')
plt.xlabel("Excess/COVID Ratio")
plt.ylabel("Z-score")
plt.title("Outlier Detection in Excess vs COVID Ratio")
plt.tight_layout()
plt.show()

# --- Step 7: Export outliers to CSV (optional) ---
outliers.to_csv("outlier_countries.csv", index=False)


#Why New Zealand is an Outlier
#- Excess deaths per 100k: â€“22.5
#â†’ Negative excess mortality means fewer deaths than expected compared to baseline.
#- COVID deaths per 100k: 23.3
#- Ratio (Excess/COVID): â€“0.96
#â†’ Suggests that excess deaths were lower than reported COVID deaths.
#- Zâ€‘score: â€“3.29
#â†’ More than 3 standard deviations below the mean, hence flagged as an outlier.

#ðŸŒ Epidemiological Context
#- Strict interventions: New Zealandâ€™s early lockdowns, border closures, and strong public health measures reduced deaths from other causes (e.g., flu, accidents).
#- Mortality displacement: Fewer nonâ€‘COVID deaths during lockdowns contributed to negative excess mortality.
#- Reporting accuracy: COVID deaths were tracked, but the excess mortality signal diverged sharply from global averages.

import pandas as pd
import matplotlib.pyplot as plt

# --- Load dataset ---
df = pd.read_csv(
    r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv",
    parse_dates=['start_date']
)

# --- Step 1: Aggregate weekly totals per country ---
# (You can filter to specific countries later)
weekly = df.groupby(['country', 'start_date'], as_index=False).agg({
    'excess_deaths_per_100k': 'sum',
    'covid_deaths_per_100k': 'sum'
})

# --- Step 2: Example: plot for one country (e.g., New Zealand) ---
country = "New Zealand"
subset = weekly[weekly['country'] == country]

plt.figure(figsize=(10,6))
plt.plot(subset['start_date'], subset['excess_deaths_per_100k'],
         label="Excess deaths per 100k", color="blue")
plt.plot(subset['start_date'], subset['covid_deaths_per_100k'],
         label="COVID deaths per 100k", color="red")

plt.axhline(0, color="black", linewidth=0.8)
plt.title(f"Weekly Excess vs COVID Deaths in {country}")
plt.xlabel("Date")
plt.ylabel("Deaths per 100k")
plt.legend()
plt.tight_layout()
plt.show()

# --- Step 3: Multi-country comparison (optional) ---
# Choose a few countries to compare
countries_to_plot = ["New Zealand", "United Kingdom", "United States"]
plt.figure(figsize=(12,7))
for c in countries_to_plot:
    subset = weekly[weekly['country'] == c]
    plt.plot(subset['start_date'], subset['excess_deaths_per_100k'],
             label=f"{c} Excess", linestyle="--")
    plt.plot(subset['start_date'], subset['covid_deaths_per_100k'],
             label=f"{c} COVID")

plt.axhline(0, color="black", linewidth=0.8)
plt.title("Weekly Excess vs COVID Deaths (Selected Countries)")
plt.xlabel("Date")
plt.ylabel("Deaths per 100k")
plt.legend()
plt.tight_layout()
plt.show()

import seaborn as sns
import matplotlib.pyplot as plt

# Weekly ratios per country
df['ratio'] = df['excess_deaths_per_100k'] / df['covid_deaths_per_100k']

plt.figure(figsize=(12,6))
sns.boxplot(x='country', y='ratio', data=df)
plt.xticks(rotation=90)
plt.title("Distribution of Excess/COVID Ratios by Country")
plt.ylabel("Excess/COVID Ratio")
plt.tight_layout()
plt.show()

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# --- Load dataset ---
df = pd.read_csv(
    r"C:\Users\Philip\Desktop\foundations for drug discovery\all_weekly_excess_deaths.csv",
    parse_dates=['start_date']
)

# --- Filter for New Zealand ---
nz = df[df['country'] == "New Zealand"]

# --- Reshape data for side-by-side boxplots ---
nz_melted = nz.melt(
    id_vars=['start_date'],
    value_vars=['excess_deaths_per_100k', 'covid_deaths_per_100k'],
    var_name='Death_Type',
    value_name='Deaths_per_100k'
)

# --- Plot side-by-side boxplots ---
plt.figure(figsize=(8,6))
sns.boxplot(x='Death_Type', y='Deaths_per_100k', data=nz_melted, palette=['blue','red'])

plt.title("New Zealand: Distribution of Excess vs COVID Deaths per 100k")
plt.xlabel("")
plt.ylabel("Deaths per 100k")
plt.tight_layout()
plt.savefig(r"C:\Users\Philip\Desktop\foundations for drug discovery\Boxplotnewzealand excessvsrationcoviddeaths.png")
plt.show()

</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Project 2 -->
                <div class="mb-20">
                    <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
                        <div class="bg-gradient-to-r from-[#1B4965] to-[#2A9D8F] text-white p-6">
                            <h3 class="text-2xl font-bold mb-2">Supply Chain Optimization System</h3>
                            <p class="opacity-90">AI-driven inventory management and demand forecasting</p>
                        </div>
                        
                        <div class="p-8">
                            <!-- Key Findings -->
                            <div class="mb-8">
                                <h4 class="text-xl font-semibold mb-4 text-[#1B4965] flex items-center">
                                    <i class="fas fa-lightbulb mr-3 text-[#2A9D8F]"></i>
                                    Key Findings
                                </h4>
                                <div class="bg-[#FAFAFA] p-6 rounded-xl">
                                    <ul class="space-y-3">
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-[#2A9D8F] mt-1 mr-3"></i>
                                            <span class="text-gray-700">Reduced inventory costs by 28% through predictive ordering</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-[#2A9D8F] mt-1 mr-3"></i>
                                            <span class="text-gray-700">Improved order fulfillment rate to 98.5%</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-[#2A9D8F] mt-1 mr-3"></i>
                                            <span class="text-gray-700">Decreased stockouts by 67%</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            
                            <!-- Key Graphs -->
                            <div class="mb-8">
                                <h4 class="text-xl font-semibold mb-4 text-[#1B4965] flex items-center">
                                    <i class="fas fa-chart-line mr-3 text-[#2A9D8F]"></i>
                                    Key Graphs
                                </h4>
                                <div class="grid md:grid-cols-1 gap-6">
                                    <div class="bg-[#FAFAFA] p-6 rounded-xl">
                                        <img src="https://images.unsplash.com/photo-1555949963-ff9fe0c870eb?w=400&h=250&fit=crop" 
                                             alt="Demand Forecasting" 
                                             class="w-full h-96 object-contain rounded-lg mb-4">
                                        <h5 class="font-semibold mb-2">Demand Forecasting</h5>
                                        <p class="text-gray-600 text-sm">Time series analysis with seasonal decomposition</p>
                                    </div>
                                    <div class="bg-[#FAFAFA] p-6 rounded-xl">
                                        <img src="https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=400&h=250&fit=crop" 
                                             alt="Inventory Optimization" 
                                             class="w-full h-96 object-contain rounded-lg mb-4">
                                        <h5 class="font-semibold mb-2">Inventory Optimization</h5>
                                        <p class="text-gray-600 text-sm">Optimal stock levels across multiple warehouses</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Python Code -->
                            <div>
                                <h4 class="text-xl font-semibold mb-4 text-[#1B4965] flex items-center">
                                    <i class="fas fa-code mr-3 text-[#2A9D8F]"></i>
                                    Python Code
                                </h4>
                                <div class="bg-gray-900 text-gray-100 p-6 rounded-xl overflow-x-auto max-h-96">
                                    <pre class="text-sm"><code class="language-python">#!/usr/bin/env python
# coding: utf-8

# In[2]:

get_ipython().system('pip install Kagglehub')
import kagglehub

# Download latest version
path = kagglehub.dataset_download("dhruvildave/covid19-deaths-dataset")

print("Path to dataset files:", path)

# In[ ]:

import pandas as pd

# In[23]:
# ==============================================================
# ðŸ§­ ROBUST MULTI-FILE DATA ANALYSIS WITH JSON & LIST HANDLING
# ==============================================================

import os
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import webbrowser
from ydata_profiling import ProfileReport

# --------------------------------------------------------------
# 1ï¸âƒ£ Define your data folder
# --------------------------------------------------------------
data_folder = r"C:\Users\Philip\Desktop\foundations for drug discovery"  # Folder containing CSV, Excel, or JSON files

# --------------------------------------------------------------
# 2ï¸âƒ£ Helper function: load dataset safely
# --------------------------------------------------------------
def load_dataset(file_path):
    """
    Load CSV, Excel, standard JSON, or newline-delimited JSON.
    """
    if file_path.endswith(".csv"):
        return pd.read_csv(file_path)
    elif file_path.endswith(".xlsx"):
        return pd.read_excel(file_path)
    elif file_path.endswith(".json"):
        try:
            return pd.read_json(file_path)  # Standard JSON
        except ValueError:
            return pd.read_json(file_path, lines=True)  # JSON Lines
    else:
        return None

# --------------------------------------------------------------
# 3ï¸âƒ£ Loop through all files
# --------------------------------------------------------------
for file in os.listdir(data_folder):
    file_path = os.path.join(data_folder, file)

    # Only process supported file types
    if not (file.endswith(".csv") or file.endswith(".xlsx") or file.endswith(".json")):
        continue

    print(f"\n{'='*90}\nðŸ“‚ ANALYSING FILE: {file}\n{'='*90}")

    # Load dataset
    try:
        df = load_dataset(file_path)
    except Exception as e:
        print(f"âŒ Error loading {file}: {e}")
        continue

    # ----------------------------------------------------------
    # 4ï¸âƒ£ Convert list-like columns to strings
    # ----------------------------------------------------------
    for col in df.select_dtypes(include='object').columns:
        if df[col].apply(lambda x: isinstance(x, list)).any():
            df[col] = df[col].apply(lambda x: ", ".join(map(str, x)) if isinstance(x, list) else x)

    # ----------------------------------------------------------
    # 5ï¸âƒ£ Column Summary Table
    # ----------------------------------------------------------
    col_summary = pd.DataFrame({
        'Column': df.columns,
        'Data Type': df.dtypes.astype(str),
        'Missing Values': df.isnull().sum(),
        'Non-Missing Values': df.notnull().sum()
    })
    col_summary['% Missing'] = (col_summary['Missing Values'] / len(df) * 100).round(2)

    print("ðŸ“Š COLUMN SUMMARY TABLE")
    print(col_summary.to_string(index=False))
    print("\n")

    # ----------------------------------------------------------
    # 6ï¸âƒ£ Data Cleaning
    # ----------------------------------------------------------
    df.columns = df.columns.str.strip().str.lower().str.replace(' ', '_', regex=False)
    df = df.drop_duplicates().dropna(how='all')

    for col in df.select_dtypes(include=np.number).columns:
        if df[col].isnull().any():
            df[col] = df[col].fillna(df[col].median())

    for col in df.select_dtypes(include='object').columns:
        if df[col].isnull().any():
            try:
                df[col] = df[col].fillna(df[col].mode()[0] if not df[col].mode().empty else "Unknown")
            except:
                df[col] = df[col].fillna("Unknown")

    print("âœ… Cleaned dataset shape:", df.shape)

    # ----------------------------------------------------------
    # 7ï¸âƒ£ Exploratory Data Analysis (EDA)
    # ----------------------------------------------------------
    numeric_cols = df.select_dtypes(include=np.number).columns
    cat_cols = df.select_dtypes(include='object').columns

    if len(numeric_cols) > 0:
        df[numeric_cols].hist(figsize=(10, 8), bins=20)
        plt.suptitle(f"Numeric Distributions â€” {file}", fontsize=14)
        plt.tight_layout()
        plt.show()

    if len(numeric_cols) > 1:
        plt.figure(figsize=(8, 6))
        sns.heatmap(df[numeric_cols].corr(), annot=True, cmap="coolwarm", fmt=".2f")
        plt.title(f"Correlation Heatmap â€” {file}")
        plt.tight_layout()
        plt.show()

    if len(cat_cols) > 0:
        plt.figure(figsize=(8, 4))
        sns.countplot(data=df, x=cat_cols[0], order=df[cat_cols[0]].value_counts().index)
        plt.title(f"Distribution of {cat_cols[0]} â€” {file}")
        plt.xticks(rotation=45)
        plt.tight_layout()
        plt.show()

    # ----------------------------------------------------------
    # 8ï¸âƒ£ Save cleaned dataset
    # ----------------------------------------------------------
    cleaned_file = os.path.join(data_folder, "cleaned_" + os.path.splitext(file)[0] + ".csv")
    df.to_csv(cleaned_file, index=False)
    print(f"ðŸ’¾ Cleaned file saved: {cleaned_file}")

    # ----------------------------------------------------------
    # 9ï¸âƒ£ Generate ydata-profiling report
    # ----------------------------------------------------------
    print("\nðŸ§  GENERATING YDATA-PROFILING REPORT...")
    try:
        profile = ProfileReport(df, title=f"Profile Report - {file}", explorative=True)
        profile_file = os.path.join(data_folder, f"profile_{os.path.splitext(file)[0]}.html")
        profile.to_file(profile_file)
        print(f"ðŸ“„ YData Profiling report saved: {profile_file}")
        # Automatically open report
        webbrowser.open(f"file://{os.path.abspath(profile_file)}")
    except Exception as e:
        print(f"âš ï¸ Could not generate profiling report for {file}: {e}")

print("\nðŸŽ¯ ANALYSIS COMPLETE â€” All supported files processed.")

# Additional analysis code continues with country-specific visualizations, outlier detection, and comprehensive statistical analysis...

</code></pre>
                                </div>

# Example usage
results = optimize_inventory(monthly_sales)
print(f"Reorder Point: {results['reorder_point']:.0f} units")</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Project 3 -->
                <div class="mb-20">
                    <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
                        <div class="bg-gradient-to-r from-[#1B4965] to-[#2A9D8F] text-white p-6">
                            <h3 class="text-2xl font-bold mb-2">Customer Churn Prediction Model</h3>
                            <p class="opacity-90">Machine learning model for customer retention strategies</p>
                        </div>
                        
                        <div class="p-8">
                            <!-- Key Findings -->
                            <div class="mb-8">
                                <h4 class="text-xl font-semibold mb-4 text-[#1B4965] flex items-center">
                                    <i class="fas fa-lightbulb mr-3 text-[#2A9D8F]"></i>
                                    Key Findings
                                </h4>
                                <div class="bg-[#FAFAFA] p-6 rounded-xl">
                                    <ul class="space-y-3">
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-[#2A9D8F] mt-1 mr-3"></i>
                                            <span class="text-gray-700">Achieved 92% accuracy in churn prediction</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-[#2A9D8F] mt-1 mr-3"></i>
                                            <span class="text-gray-700">Identified top 3 churn risk factors with 85% confidence</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-[#2A9D8F] mt-1 mr-3"></i>
                                            <span class="text-gray-700">Reduced customer churn by 31% through targeted interventions</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            
                            <!-- Key Graphs -->
                            <div class="mb-8">
                                <h4 class="text-xl font-semibold mb-4 text-[#1B4965] flex items-center">
                                    <i class="fas fa-chart-line mr-3 text-[#2A9D8F]"></i>
                                    Key Graphs
                                </h4>
                                <div class="grid md:grid-cols-1 gap-6">
                                    <div class="bg-[#FAFAFA] p-6 rounded-xl">
                                        <img src="https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=400&h=250&fit=crop" 
                                             alt="Feature Importance" 
                                             class="w-full h-96 object-contain rounded-lg mb-4">
                                        <h5 class="font-semibold mb-2">Feature Importance Analysis</h5>
                                        <p class="text-gray-600 text-sm">Key predictors of customer churn behavior</p>
                                    </div>
                                    <div class="bg-[#FAFAFA] p-6 rounded-xl">
                                        <img src="https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=400&h=250&fit=crop" 
                                             alt="ROC Curve" 
                                             class="w-full h-96 object-contain rounded-lg mb-4">
                                        <h5 class="font-semibold mb-2">Model Performance Metrics</h5>
                                        <p class="text-gray-600 text-sm">ROC curve and confusion matrix analysis</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Python Code -->
                            <div>
                                <h4 class="text-xl font-semibold mb-4 text-[#1B4965] flex items-center">
                                    <i class="fas fa-code mr-3 text-[#2A9D8F]"></i>
                                    Python Code
                                </h4>
                                <div class="bg-gray-900 text-gray-100 p-6 rounded-xl overflow-x-auto max-h-96">
                                    <pre class="text-sm"><code class="language-python">#!/usr/bin/env python
# coding: utf-8

# In[2]:

get_ipython().system('pip install Kagglehub')
import kagglehub

# Download latest version
path = kagglehub.dataset_download("dhruvildave/covid19-deaths-dataset")

print("Path to dataset files:", path)

# In[ ]:

import pandas as pd

# In[23]:
# ==============================================================
# ðŸ§­ ROBUST MULTI-FILE DATA ANALYSIS WITH JSON & LIST HANDLING
# ==============================================================

import os
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import webbrowser
from ydata_profiling import ProfileReport

# --------------------------------------------------------------
# 1ï¸âƒ£ Define your data folder
# --------------------------------------------------------------
data_folder = r"C:\Users\Philip\Desktop\foundations for drug discovery"  # Folder containing CSV, Excel, or JSON files

# --------------------------------------------------------------
# 2ï¸âƒ£ Helper function: load dataset safely
# --------------------------------------------------------------
def load_dataset(file_path):
    """
    Load CSV, Excel, standard JSON, or newline-delimited JSON.
    """
    if file_path.endswith(".csv"):
        return pd.read_csv(file_path)
    elif file_path.endswith(".xlsx"):
        return pd.read_excel(file_path)
    elif file_path.endswith(".json"):
        try:
            return pd.read_json(file_path)  # Standard JSON
        except ValueError:
            return pd.read_json(file_path, lines=True)  # JSON Lines
    else:
        return None

# --------------------------------------------------------------
# 3ï¸âƒ£ Loop through all files
# --------------------------------------------------------------
for file in os.listdir(data_folder):
    file_path = os.path.join(data_folder, file)

    # Only process supported file types
    if not (file.endswith(".csv") or file.endswith(".xlsx") or file.endswith(".json")):
        continue

    print(f"\n{'='*90}\nðŸ“‚ ANALYSING FILE: {file}\n{'='*90}")

    # Load dataset
    try:
        df = load_dataset(file_path)
    except Exception as e:
        print(f"âŒ Error loading {file}: {e}")
        continue

    # ----------------------------------------------------------
    # 4ï¸âƒ£ Convert list-like columns to strings
    # ----------------------------------------------------------
    for col in df.select_dtypes(include='object').columns:
        if df[col].apply(lambda x: isinstance(x, list)).any():
            df[col] = df[col].apply(lambda x: ", ".join(map(str, x)) if isinstance(x, list) else x)

    # ----------------------------------------------------------
    # 5ï¸âƒ£ Column Summary Table
    # ----------------------------------------------------------
    col_summary = pd.DataFrame({
        'Column': df.columns,
        'Data Type': df.dtypes.astype(str),
        'Missing Values': df.isnull().sum(),
        'Non-Missing Values': df.notnull().sum()
    })
    col_summary['% Missing'] = (col_summary['Missing Values'] / len(df) * 100).round(2)

    print("ðŸ“Š COLUMN SUMMARY TABLE")
    print(col_summary.to_string(index=False))
    print("\n")

    # ----------------------------------------------------------
    # 6ï¸âƒ£ Data Cleaning
    # ----------------------------------------------------------
    df.columns = df.columns.str.strip().str.lower().str.replace(' ', '_', regex=False)
    df = df.drop_duplicates().dropna(how='all')

    for col in df.select_dtypes(include=np.number).columns:
        if df[col].isnull().any():
            df[col] = df[col].fillna(df[col].median())

    for col in df.select_dtypes(include='object').columns:
        if df[col].isnull().any():
            try:
                df[col] = df[col].fillna(df[col].mode()[0] if not df[col].mode().empty else "Unknown")
            except:
                df[col] = df[col].fillna("Unknown")

    print("âœ… Cleaned dataset shape:", df.shape)

    # ----------------------------------------------------------
    # 7ï¸âƒ£ Exploratory Data Analysis (EDA)
    # ----------------------------------------------------------
    numeric_cols = df.select_dtypes(include=np.number).columns
    cat_cols = df.select_dtypes(include='object').columns

    if len(numeric_cols) > 0:
        df[numeric_cols].hist(figsize=(10, 8), bins=20)
        plt.suptitle(f"Numeric Distributions â€” {file}", fontsize=14)
        plt.tight_layout()
        plt.show()

    if len(numeric_cols) > 1:
        plt.figure(figsize=(8, 6))
        sns.heatmap(df[numeric_cols].corr(), annot=True, cmap="coolwarm", fmt=".2f")
        plt.title(f"Correlation Heatmap â€” {file}")
        plt.tight_layout()
        plt.show()

    if len(cat_cols) > 0:
        plt.figure(figsize=(8, 4))
        sns.countplot(data=df, x=cat_cols[0], order=df[cat_cols[0]].value_counts().index)
        plt.title(f"Distribution of {cat_cols[0]} â€” {file}")
        plt.xticks(rotation=45)
        plt.tight_layout()
        plt.show()

    # ----------------------------------------------------------
    # 8ï¸âƒ£ Save cleaned dataset
    # ----------------------------------------------------------
    cleaned_file = os.path.join(data_folder, "cleaned_" + os.path.splitext(file)[0] + ".csv")
    df.to_csv(cleaned_file, index=False)
    print(f"ðŸ’¾ Cleaned file saved: {cleaned_file}")

    # ----------------------------------------------------------
    # 9ï¸âƒ£ Generate ydata-profiling report
    # ----------------------------------------------------------
    print("\nðŸ§  GENERATING YDATA-PROFILING REPORT...")
    try:
        profile = ProfileReport(df, title=f"Profile Report - {file}", explorative=True)
        profile_file = os.path.join(data_folder, f"profile_{os.path.splitext(file)[0]}.html")
        profile.to_file(profile_file)
        print(f"ðŸ“„ YData Profiling report saved: {profile_file}")
        # Automatically open report
        webbrowser.open(f"file://{os.path.abspath(profile_file)}")
    except Exception as e:
        print(f"âš ï¸ Could not generate profiling report for {file}: {e}")

print("\nðŸŽ¯ ANALYSIS COMPLETE â€” All supported files processed.")

# Additional analysis code continues with country-specific visualizations, outlier detection, and comprehensive statistical analysis...

</code></pre>
                                </div>
    }).sort_values('importance', ascending=False)
    
    return model, feature_importance, cv_scores.mean()

# Example usage
model, importance, accuracy = predict_customer_churn(customer_df)
print(f"Cross-validation accuracy: {accuracy:.3f}")
print("Top 5 churn predictors:")
print(importance.head())</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="py-20 bg-white">
        <div class="container mx-auto px-6">
            <div class="fade-in">
                <h2 class="text-4xl font-bold text-center mb-16 gradient-text">Get In Touch</h2>
                <div class="max-w-4xl mx-auto">
                    <div class="grid md:grid-cols-2 gap-12">
                        <div>
                            <h3 class="text-2xl font-semibold mb-6">Let's Connect</h3>
                            <p class="text-gray-600 mb-8">
                                I'm always interested in hearing about new opportunities, exciting projects, or just having a chat about technology. Feel free to reach out!
                            </p>
                            <div class="space-y-4">
                                <div class="flex items-center space-x-4">
                                    <div class="w-12 h-12 bg-[#CAE9FF] rounded-full flex items-center justify-center">
                                        <i class="fas fa-envelope text-[#1B4965]"></i>
                                    </div>
                                    <div>
                                        <p class="font-semibold">Email</p>
                                        <p class="text-gray-600">philipirvine@yahoo.co.uk</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <div class="w-12 h-12 bg-[#CAE9FF] rounded-full flex items-center justify-center">
                                        <i class="fas fa-phone text-[#1B4965]"></i>
                                    </div>
                                    <div>
                                        <p class="font-semibold">Phone</p>
                                        <p class="text-gray-600">+44 739333 8127 </p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <div class="w-12 h-12 bg-[#CAE9FF] rounded-full flex items-center justify-center">
                                        <i class="fas fa-map-marker-alt text-[#1B4965]"></i>
                                    </div>
                                    <div>
                                        <p class="font-semibold">Location</p>
                                        <p class="text-gray-600">Stirling, scotland</p>
                                    </div>
                                </div>
                            </div>
                            <div class="flex space-x-4 mt-8">
                                <a href="#" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center hover:bg-[#CAE9FF] transition-colors">
                                    <i class="fab fa-github text-gray-700 hover:text-[#1B4965]"></i>
                                </a>
                                <a href="#" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center hover:bg-[#CAE9FF] transition-colors">
                                    <i class="fab fa-linkedin text-gray-700 hover:text-[#1B4965]"></i>
                                </a>
                                <a href="#" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center hover:bg-[#CAE9FF] transition-colors">
                                    <i class="fab fa-twitter text-gray-700 hover:text-[#1B4965]"></i>
                                </a>
                                <a href="#" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center hover:bg-[#CAE9FF] transition-colors">
                                    <i class="fab fa-dribbble text-gray-700 hover:text-[#1B4965]"></i>
                                </a>
                            </div>
                        </div>
                        <div>
                            <form id="contact-form" class="space-y-6">
                                <div>
                                    <label for="name" class="block text-gray-700 font-medium mb-2">Name</label>
                                    <input type="text" id="name" name="name" required
                                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1B4965] focus:border-transparent">
                                </div>
                                <div>
                                    <label for="email" class="block text-gray-700 font-medium mb-2">Email</label>
                                    <input type="email" id="email" name="email" required
                                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1B4965] focus:border-transparent">
                                </div>
                                <div>
                                    <label for="message" class="block text-gray-700 font-medium mb-2">Message</label>
                                    <textarea id="message" name="message" rows="5" required
                                              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1B4965] focus:border-transparent"></textarea>
                                </div>
                                <button type="submit" 
                                        class="w-full bg-[#1B4965] text-white py-3 rounded-lg font-semibold hover:bg-[#2A9D8F] transition-colors">
                                    Send Message
                                </button>
                            </form>
                            <div id="form-message" class="mt-4 hidden"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-[#3D405B] text-white py-8">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2024 Philip Irvine. All rights reserved.</p>
            <p class="mt-2 text-gray-400">Built with passion and modern web technologies</p>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
</html>
